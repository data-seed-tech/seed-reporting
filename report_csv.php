<?phprequire_once("./connection.inc");require_once("./xml_functions.inc");$reportId = @$_GET['id'];//print $reportId;if($reportId == ""){    $reportId = @$_POST['id'];}if($reportId == ""){    $reportId = 1;}$for = @$_GET['for'];   // poate fi: 'count' sau 'report'//print $for;if($for == ""){    $for = @$_POST['for'];}if($for == ""){    $for = "report";}else{    if($for != "count" && $for!= "report")    {        print ("ERROR! Parameter 'for' can be only: 'count' or 'report'!!!");    }}$query_report = "SELECT reportName, reportDescription, activationCriteria, sqlReport                 FROM seed_app_reports WHERE reportId = '" . $reportId . "';";//print $query_report;$result_report = $conn -> query($query_report);$row_report = $result_report ->fetch_object();$err =   $conn->error;print $err;$reportName = $row_report->reportName;$reportDescription = $row_report->reportDescription;if($for == "count"){    $query = $row_report->activationCriteria;}else{    $query = $row_report->sqlReport;}// executam queriul:$xml = GetXMLfromQuery($conn, $query);   // xml_functions.inc//print_r ($xml);$proc = new XSLTProcessor();$xslCSV = GetXSL_CSV();$proc->importStyleSheet($xslCSV);$CSV = $proc->transformToXML($xml);$filename = $reportName . " " . date('Ymd') . ".csv";header("Content-Disposition: attachment; filename=\"$filename\"");header("Content-Type: application/vnd.ms-excel");header("Pragma: no-cache");header("Expires: 0");print ($CSV);?>    